function A = r1circuit_getA(Rx,R,C,L,w)

A=sparse(16,16);

rx = 1/Rx;
r  = 1/R;
c  = 1i*w*C;
l  = 1i/(w*L);

A(1,1) = r+c;
A(1,2) = -c;    A(2,1) = -c;
A(1,6) = -r;    A(6,1) = -r;

A(2,2) = 2*r+c-l;
A(2,3) = -r;    A(3,2)  = -r;
A(2,6) =  l;    A(6,2)  =  l;
A(2,15)= -r;    A(15,2) = -r;

A(3,3) = 2*(r+c);
A(3,4) = -c;    A(4,3)  = -c;
A(3,15)= -c;    A(15,3) = -c;
A(3,16) =-r;    A(16,3) = -r;

A(4,4) = 2*r+c-l;
A(4,5) = -r;    A(5,4)  = -r;
A(4,7) = -r;    A(7,4)  = -r;
A(4,16)=  l;    A(16,4) =  l;

A(5,5) = r+c;
A(5,7) = -c;    A(7,5)  = -c;

A(6,6)= 3*r+c-l;
A(6,8)  = -r;   A(8,6)  = -r;
A(6,15) = -r;   A(15,6) = -r;

A(7,7) = 4*r+c;
A(7,10) = -r;   A(10,7) = -r;
A(7,16) = -r;   A(16,7) = -r;

A(8,8) = 2*r+c-l;
A(8,11) = -c;   A(11,8) = -c;
A(8,12) =  l;   A(12,8) =  l;

A(9,9) = 2*r+c-l;
A(9,10) = -r;   A(10,9) = -r;
A(9,13) = -c;   A(13,9) = -c;
A(9,14) =  l;   A(14,9) =  l;
A(9,16) = -r;   A(16,9) = -r;

A(10,10) = 3*r+c;
A(10,14) = -r;  A(14,10) = -r;
A(10,16) = -c;  A(16,10) = -c;

A(11,11) = r+c;
A(11,12) = -r;  A(12,11) = -r;

A(12,12) = 3*r-l;
A(12,13) = -r;  A(13,12) = -r;

A(13,13) = 2*r+c;
A(13,14) = -r;  A(14,13) = -r;

A(14,14) = 2*r-l;

A(15,15) = rx+3*r+c;
A(15,16) = -rx; A(16,15) = -rx;

A(16,16) = rx+3*r+c-l;
