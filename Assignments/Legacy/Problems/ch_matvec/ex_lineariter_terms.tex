% Required for hand-in: getit.m
% Required for solution: None

\begin{problem}[Complexity of a \Matlab~ function] \label{prb:lineariter} 
In this problem we recall a concept from linear algebra, the diagonalization
of a square matrix. Unless you can still define what this means, please look
up the chapter on ``eigenvalues'' in your linear algebra lecture notes. This
problem also has a subtle relationship with \ref{prb:Powers}

We consider the \Matlab~ function defined in \verb|getit.m|~ (cf. \cref{mc:lineariter})
\lstinputlisting[language=matlab,caption={\Matlab implementation of \func{getit} for \ref{prb:lineariter}.},label={mc:lineariter}]
{\problems/\chpt/MATLAB/getit.m}

\begin{hint}
  Give the command \func{doc eig} in \Matlab{} to understand what \texttt{eig}
  does. 
\end{hint}

\begin{hint}
  You may use that \texttt{eig} applied to an $n\times n$-matrix requires an
  asymptotic computational effort of $O(n^{3})$ for $n\to\infty$.
\end{hint}

\begin{hint}
 in \Matlab, the function \func{diag(x)} for $\vec{x} \in \mathbb{R}^n$, builds a diagonal, $n \times n$ matrix with $\vec{x}$ as diagonal. If $\vec{M}$ is a $n \times n$ matrix, \func{diag(M)} returns (extracts) the diagonal of $\vec{M}$ as a vector in $\mathbb{R}^n$.
\end{hint}

\begin{hint}
 the operator \verb|v.^k| for $v \in \mathbb{R}^n$ and $k \in \mathbb{N} \setminus \{ 0 \}$ returns the vector with components $v_i ^k$ (i.e. component-wise exponent)
\end{hint}

\begin{subproblem}[2]
 What is the output of \func{getit}, when $A$ is a diagonalizable $n \times n$ matrix, $x \in \mathbb{R}^n$ and $k \in \mathbb{N}$?
 
 \begin{solution}
   The output is $\vec{y}$ s.t. $\vec{y} = \vec{A}^k \vec{x}$. The eigenvalue decomposition of the matrix $\vec{A} = \vec{S} \vec{D} \vec{S}^{-1}$ (where $\vec{D}$ is diagonal and $\vec{S}$ invertible), allows us to write:
   \[
    \vec{A}^k = (\vec{S} \vec{D} \vec{S}^{-1})^k = \vec{S} \vec{D}^k \vec{S}^{-1},
   \]
   and $\vec{D}^k$ can be computed efficiently (component-wise) for diagonal matrices.
 \end{solution}

\end{subproblem}

\begin{subproblem}[1]
  Fix $k \in \mathbb{N}$. Discuss (in detail) the asymptotic complexity of
  \func{getit} $n\to\infty$.
 
 \begin{solution}
  The algorithm comprises the following operations:
  \begin{itemize}
   \item diagonalization of a full-rank matrix $\vec{A}$ is $O(n^3)$;
   \item matrix-vector multiplication is $O(n^2)$;
   \item raising a vector in $\mathbb{R}^n$ for the power $k$ has complexity $O(n)$;
   \item solve a fully determined linear system: $O(n^3)$.
  \end{itemize}
  The complexity of the algorithm is dominated by the operations with higher exponent. Therefore the total complexity of the algorithm is $O(n^3)$ for $n \rightarrow \infty$.
 \end{solution}
\end{subproblem}

\end{problem}
