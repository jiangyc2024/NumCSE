\usepackage{etex}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{amsmath,geometry}
\usepackage{amsfonts}
\usepackage{pifont}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{latexsym}
\usepackage{MnSymbol}
\usepackage{graphicx}
\usepackage[dvipsnames,svgnames,table]{xcolor}
\usepackage{ifthen}
\usepackage{times}
\usepackage{fancyhdr}
\usepackage{pst-plot}
% \usepackage{verbdef}
%\usepackage{pst-plot,pst-tricks}
\usepackage{psfrag}
% \usepackage{subfig} 
\usepackage{epsdice} 
\usepackage{epstopdf} 
\usepackage{environ}
\usepackage{enumerate}
\usepackage{tikz}
\usepackage{circuitikz}
\usepackage{cprotect}
\usepackage{caption}
\usepackage{subcaption}
\usepackage[backend=bibtex, doi=false,isbn=false,url=false]{biblatex}
% \usepackage{bibtex}

\usepackage[framed,numbered]{\packages/mcode}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% LISTINGS package and configurations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{listings}
\usepackage{lstlinebgrd}

% Define appearance of MATLAB code 
\definecolor{MyDarkGreen}{rgb}{0.0,0.4,0.0}
\lstdefinestyle{mcode}{
 language=Matlab,                        % Use MATLAB
  frame=single,                           % Single frame around code
  basicstyle=\ttfamily\color{black},  % Use small true type font
  keywordstyle=[1]\color{brown}\bf,  % MATLAB functions bold and blue
  keywordstyle=[2]\color{purple},         % MATLAB function arguments purple
  keywordstyle=[3]\color{blue}\underbar,  % User functions underlined and blue
  identifierstyle=,                       % Nothing special about identifiers
  % Comments small dark green courier
  commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small,
  stringstyle=\color{Purple},             % Strings are purple
  showstringspaces=false,                 % Don't put marks in string spaces
  tabsize=5,                              % 5 spaces per tab
  % 
  %%% Put standard MATLAB functions not included in the default
  %%% language here
  morekeywords={numel,xlim,ylim,var,alpha,factorial,poissrnd,normpdf,normcdf},
  % 
  %%% Put MATLAB function parameters here
  morekeywords=[2]{on, off, interp},
  % 
  %%% Put user defined functions here
  morekeywords=[3]{},
  % 
  morecomment=[l][\color{Blue}]{...},     % Line continuation (...) like blue comment
  numbers=left,                           % Line numbers on left
  firstnumber=1,                          % Line numbers start with line 1
  numberstyle=\tiny\color{blue},          % Line numbers are blue
  stepnumber=1,                           % Line numbers go in steps of 5
  breaklines=true,
  breakatwhitespace=true,
  emptylines=1,
  texcl=false,
  escapechar=&,
  mathescape=true,
  xleftmargin=2.5ex,
  emphstyle={\color{red}\bfseries},
  escapeinside={@}{@},   
}
% Plain and simple MATLAB code

\lstdefinestyle{matlab}{
 language=Matlab,frame=none,
 basicstyle=\ttfamily\color{darkviolet},
  keywordstyle=[1]\color{brown}\bf,
  keywordstyle=[2]\color{purple},
  keywordstyle=[3]\color{blue}\underbar,
  identifierstyle=,
  commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small,
  stringstyle=\color{Purple},
  showstringspaces=false,
  tabsize=5,
  morekeywords={numel,xlim,ylim,var,alpha,factorial,poissrnd,normpdf,normcdf},
  morekeywords=[2]{on, off, interp},
  morekeywords=[3]{},
  morecomment=[l][\color{Blue}]{...},
  numbers=none,
  breaklines=true,
  breakatwhitespace=true,
  emptylines=1,
  texcl=true,
  escapechar=&,
  mathescape=true,
  xleftmargin=0.5ex,
  emphstyle={\color{red}\bfseries},
  escapeinside={@}{@},   
}


% Define appearance of C++ code
\lstdefinestyle{cpp}{
  language=C++,
  frame=single,                           % Single frame around code
  basicstyle=\sffamily\color{black},  % Use small true type font
  keywordstyle=[1]\color{brown}\bf,  % MATLAB functions bold and blue
  keywordstyle=[2]\color{purple},         % MATLAB function arguments purple
  keywordstyle=[3]\color{blue}\underbar,  % User functions underlined and blue
  identifierstyle=,                       % Nothing special about identifiers
  % Comments small dark green courier
  commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen}\small,
  stringstyle=\color{Purple}\small,             % Strings are purple
  showstringspaces=false,                 % Don't put marks in string spaces
  tabsize=5,                              % 5 spaces per tab
  escapeinside={@}{@},                % for invisible labels
  % 
  %%% Put standard MATLAB functions not included in the default
  %%% language here
  morekeywords={},
  % 
  %%% Put MATLAB function parameters here
  morekeywords=[2]{Dune},
  % 
  %%% Put user defined functions here
  morekeywords=[3]{},
  % 
  morecomment=[l][\color{Blue}]{...},     % Line continuation (...) like blue comment
  numbers=left,                           % Line numbers on left
  firstnumber=1,                          % Line numbers start with line 1
  numberstyle=\tiny\color{Blue},          % Line numbers are blue
  stepnumber=1,                           % Line numbers go in steps of 5
  breaklines=true,
  breakatwhitespace=true,
  emptylines=1,
  texcl= false,
  escapechar=@,
  mathescape=true,
  xleftmargin=2.5ex,
  emphstyle={\color{red}\bfseries},
  emphstyle={[2]\color{purple}\bfseries}
}
% No frills listing of C++ code
\lstdefinestyle{cppsimple}{
  language=C++,frame=none,xleftmargin=2.5ex,basicstyle=\ttfamily\color{black},
  keywordstyle=[1]\color{brown}\bf,keywordstyle=[2]\color{purple},
  keywordstyle=[3]\color{blue}\underbar,
  commentstyle=\usefont{T1}{pcr}{m}{sl}\color{MyDarkGreen},
  stringstyle=\color{Purple},showstringspaces=false, tabsize=5, numbers=none,
  firstnumber=1, numberstyle=\tiny\color{Blue}, stepnumber=1, breaklines=true,
  breakatwhitespace=true, emptylines=1, texcl=true, escapechar=@, mathescape=true,
  xleftmargin=3ex, emphstyle={\color{red}\bfseries},
  emphstyle={[2]\color{purple}\bfseries}
}

\lstset{style=mcode}

\usepackage{bookmark}
\bookmarksetup{startatroot}

\usepackage{hyperref}
\hypersetup{
  % bookmarks=true,       % show bookmarks bar?	%already defined somewhere else, the compiler complains
  unicode=false,          % non-Latin characters in AcrobatESC$B!GESC(Bs bookmarks
  pdftoolbar=true,        % show AcrobatESC$B!GESC(Bs toolbar?
  pdfmenubar=true,        % show AcrobatESC$B!GESC(Bs menu?
  pdffitwindow=true,      % page fit to window when opened
  pdftitle=\thetitle,     % title
  pdfauthor=\theauthor,   % author
  colorlinks=true,        % false: boxed links; true: colored links
  linkcolor=black,        % color of internal links
  citecolor=blue,         % color of links to bibliography
  filecolor=blue,         % color of file links
  urlcolor=blue           % color of external links
}

% crossreferencing with lecture notes 
\usepackage{xr}
\externaldocument[NCSENEW-]{../../\relpath NCSENEW}
\usepackage[capitalize]{cleveref}
\crefname{par}{\S}{\S}
\crefname{theorem}{Thm.}{Thm.}
\crefname{metatheorem}{Meta-Theorem}{Meta-Theorem}
\crefname{proposition}{Proposition}{Proposition}
\crefname{corollary}{Cor.}{Cor.}
\crefname{lemma}{Lemma}{Lemma}
\crefname{definition}{Def.}{Def.}
\crefname{notion}{Notion}{Notion}
\crefname{assumption}{Ass.}{Ass.}
\crefname{conjecture}{Conjecture}{Conjecture}
\crefname{example}{Ex.}{Ex.}
\crefname{experiment}{Exp.}{Exp.}
\crefname{remark}{Rem.}{Rem.}
\crefname{supplement}{Suppl.}{Suppl.}
\crefname{code}{Code}{Code}
\crefname{figure}{Fig.}{Fig.}
